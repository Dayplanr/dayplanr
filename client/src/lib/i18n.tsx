import { createContext, useContext, useState, useEffect, ReactNode } from "react";

export type Language = "en" | "de" | "es" | "fr" | "it" | "pt" | "nl" | "pl";

export const languageNames: Record<Language, string> = {
  en: "English",
  de: "Deutsch",
  es: "Español",
  fr: "Français",
  it: "Italiano",
  pt: "Português",
  nl: "Nederlands",
  pl: "Polski",
};

type TranslationKey = 
  | "today"
  | "goals"
  | "habits"
  | "focus"
  | "dailyProgress"
  | "tasksComplete"
  | "focusTime"
  | "streak"
  | "complete"
  | "morning"
  | "afternoon"
  | "evening"
  | "night"
  | "addTask"
  | "insights"
  | "settings"
  | "language"
  | "theme"
  | "dark"
  | "light"
  | "system"
  | "cancel"
  | "save"
  | "delete"
  | "edit"
  | "add"
  | "create"
  | "title"
  | "description"
  | "priority"
  | "high"
  | "medium"
  | "low"
  | "startFocus"
  | "pauseFocus"
  | "resumeFocus"
  | "stopFocus"
  | "focusSession"
  | "breakTime"
  | "deepWork"
  | "pomodoro"
  | "minutes"
  | "hours"
  | "days"
  | "week"
  | "month"
  | "year"
  | "today"
  | "yesterday"
  | "tomorrow"
  | "thisWeek"
  | "thisMonth"
  | "completed"
  | "inProgress"
  | "notStarted"
  | "overdue"
  | "onTrack"
  | "habitStreak"
  | "currentStreak"
  | "longestStreak"
  | "completionRate"
  | "goalProgress"
  | "addGoal"
  | "addHabit"
  | "noTasks"
  | "noGoals"
  | "noHabits"
  | "welcomeBack"
  | "goodMorning"
  | "goodAfternoon"
  | "goodEvening"
  | "of";

type Translations = Record<TranslationKey, string>;

const translations: Record<Language, Translations> = {
  en: {
    today: "Today",
    goals: "Goals",
    habits: "Habits",
    focus: "Focus",
    dailyProgress: "Daily Progress",
    tasksComplete: "tasks complete",
    focusTime: "Focus Time",
    streak: "Streak",
    complete: "complete",
    morning: "Morning",
    afternoon: "Afternoon",
    evening: "Evening",
    night: "Night",
    addTask: "Add Task",
    insights: "Insights",
    settings: "Settings",
    language: "Language",
    theme: "Theme",
    dark: "Dark",
    light: "Light",
    system: "System",
    cancel: "Cancel",
    save: "Save",
    delete: "Delete",
    edit: "Edit",
    add: "Add",
    create: "Create",
    title: "Title",
    description: "Description",
    priority: "Priority",
    high: "High",
    medium: "Medium",
    low: "Low",
    startFocus: "Start Focus",
    pauseFocus: "Pause",
    resumeFocus: "Resume",
    stopFocus: "Stop",
    focusSession: "Focus Session",
    breakTime: "Break Time",
    deepWork: "Deep Work",
    pomodoro: "Pomodoro",
    minutes: "minutes",
    hours: "hours",
    days: "days",
    week: "week",
    month: "month",
    year: "year",
    yesterday: "Yesterday",
    tomorrow: "Tomorrow",
    thisWeek: "This Week",
    thisMonth: "This Month",
    completed: "Completed",
    inProgress: "In Progress",
    notStarted: "Not Started",
    overdue: "Overdue",
    onTrack: "On Track",
    habitStreak: "Habit Streak",
    currentStreak: "Current Streak",
    longestStreak: "Longest Streak",
    completionRate: "Completion Rate",
    goalProgress: "Goal Progress",
    addGoal: "Add Goal",
    addHabit: "Add Habit",
    noTasks: "No tasks",
    noGoals: "No goals yet",
    noHabits: "No habits yet",
    welcomeBack: "Welcome back",
    goodMorning: "Good morning",
    goodAfternoon: "Good afternoon",
    goodEvening: "Good evening",
    of: "of",
  },
  de: {
    today: "Heute",
    goals: "Ziele",
    habits: "Gewohnheiten",
    focus: "Fokus",
    dailyProgress: "Tagesfortschritt",
    tasksComplete: "Aufgaben erledigt",
    focusTime: "Fokuszeit",
    streak: "Serie",
    complete: "erledigt",
    morning: "Morgen",
    afternoon: "Nachmittag",
    evening: "Abend",
    night: "Nacht",
    addTask: "Aufgabe hinzufügen",
    insights: "Einblicke",
    settings: "Einstellungen",
    language: "Sprache",
    theme: "Design",
    dark: "Dunkel",
    light: "Hell",
    system: "System",
    cancel: "Abbrechen",
    save: "Speichern",
    delete: "Löschen",
    edit: "Bearbeiten",
    add: "Hinzufügen",
    create: "Erstellen",
    title: "Titel",
    description: "Beschreibung",
    priority: "Priorität",
    high: "Hoch",
    medium: "Mittel",
    low: "Niedrig",
    startFocus: "Fokus starten",
    pauseFocus: "Pause",
    resumeFocus: "Fortsetzen",
    stopFocus: "Stopp",
    focusSession: "Fokus-Sitzung",
    breakTime: "Pausenzeit",
    deepWork: "Deep Work",
    pomodoro: "Pomodoro",
    minutes: "Minuten",
    hours: "Stunden",
    days: "Tage",
    week: "Woche",
    month: "Monat",
    year: "Jahr",
    yesterday: "Gestern",
    tomorrow: "Morgen",
    thisWeek: "Diese Woche",
    thisMonth: "Dieser Monat",
    completed: "Erledigt",
    inProgress: "In Bearbeitung",
    notStarted: "Nicht begonnen",
    overdue: "Überfällig",
    onTrack: "Auf Kurs",
    habitStreak: "Gewohnheits-Serie",
    currentStreak: "Aktuelle Serie",
    longestStreak: "Längste Serie",
    completionRate: "Abschlussrate",
    goalProgress: "Zielfortschritt",
    addGoal: "Ziel hinzufügen",
    addHabit: "Gewohnheit hinzufügen",
    noTasks: "Keine Aufgaben",
    noGoals: "Noch keine Ziele",
    noHabits: "Noch keine Gewohnheiten",
    welcomeBack: "Willkommen zurück",
    goodMorning: "Guten Morgen",
    goodAfternoon: "Guten Tag",
    goodEvening: "Guten Abend",
    of: "von",
  },
  es: {
    today: "Hoy",
    goals: "Metas",
    habits: "Hábitos",
    focus: "Enfoque",
    dailyProgress: "Progreso Diario",
    tasksComplete: "tareas completadas",
    focusTime: "Tiempo de Enfoque",
    streak: "Racha",
    complete: "completado",
    morning: "Mañana",
    afternoon: "Tarde",
    evening: "Atardecer",
    night: "Noche",
    addTask: "Agregar Tarea",
    insights: "Estadísticas",
    settings: "Configuración",
    language: "Idioma",
    theme: "Tema",
    dark: "Oscuro",
    light: "Claro",
    system: "Sistema",
    cancel: "Cancelar",
    save: "Guardar",
    delete: "Eliminar",
    edit: "Editar",
    add: "Agregar",
    create: "Crear",
    title: "Título",
    description: "Descripción",
    priority: "Prioridad",
    high: "Alta",
    medium: "Media",
    low: "Baja",
    startFocus: "Iniciar Enfoque",
    pauseFocus: "Pausar",
    resumeFocus: "Reanudar",
    stopFocus: "Detener",
    focusSession: "Sesión de Enfoque",
    breakTime: "Descanso",
    deepWork: "Trabajo Profundo",
    pomodoro: "Pomodoro",
    minutes: "minutos",
    hours: "horas",
    days: "días",
    week: "semana",
    month: "mes",
    year: "año",
    yesterday: "Ayer",
    tomorrow: "Mañana",
    thisWeek: "Esta Semana",
    thisMonth: "Este Mes",
    completed: "Completado",
    inProgress: "En Progreso",
    notStarted: "No Iniciado",
    overdue: "Atrasado",
    onTrack: "En Curso",
    habitStreak: "Racha de Hábitos",
    currentStreak: "Racha Actual",
    longestStreak: "Racha Más Larga",
    completionRate: "Tasa de Completado",
    goalProgress: "Progreso de Meta",
    addGoal: "Agregar Meta",
    addHabit: "Agregar Hábito",
    noTasks: "Sin tareas",
    noGoals: "Sin metas aún",
    noHabits: "Sin hábitos aún",
    welcomeBack: "Bienvenido de nuevo",
    goodMorning: "Buenos días",
    goodAfternoon: "Buenas tardes",
    goodEvening: "Buenas noches",
    of: "de",
  },
  fr: {
    today: "Aujourd'hui",
    goals: "Objectifs",
    habits: "Habitudes",
    focus: "Concentration",
    dailyProgress: "Progrès Quotidien",
    tasksComplete: "tâches terminées",
    focusTime: "Temps de Concentration",
    streak: "Série",
    complete: "terminé",
    morning: "Matin",
    afternoon: "Après-midi",
    evening: "Soir",
    night: "Nuit",
    addTask: "Ajouter une Tâche",
    insights: "Statistiques",
    settings: "Paramètres",
    language: "Langue",
    theme: "Thème",
    dark: "Sombre",
    light: "Clair",
    system: "Système",
    cancel: "Annuler",
    save: "Enregistrer",
    delete: "Supprimer",
    edit: "Modifier",
    add: "Ajouter",
    create: "Créer",
    title: "Titre",
    description: "Description",
    priority: "Priorité",
    high: "Haute",
    medium: "Moyenne",
    low: "Basse",
    startFocus: "Démarrer Concentration",
    pauseFocus: "Pause",
    resumeFocus: "Reprendre",
    stopFocus: "Arrêter",
    focusSession: "Session de Concentration",
    breakTime: "Pause",
    deepWork: "Travail Profond",
    pomodoro: "Pomodoro",
    minutes: "minutes",
    hours: "heures",
    days: "jours",
    week: "semaine",
    month: "mois",
    year: "année",
    yesterday: "Hier",
    tomorrow: "Demain",
    thisWeek: "Cette Semaine",
    thisMonth: "Ce Mois",
    completed: "Terminé",
    inProgress: "En Cours",
    notStarted: "Non Commencé",
    overdue: "En Retard",
    onTrack: "En Bonne Voie",
    habitStreak: "Série d'Habitudes",
    currentStreak: "Série Actuelle",
    longestStreak: "Plus Longue Série",
    completionRate: "Taux de Complétion",
    goalProgress: "Progrès de l'Objectif",
    addGoal: "Ajouter un Objectif",
    addHabit: "Ajouter une Habitude",
    noTasks: "Aucune tâche",
    noGoals: "Aucun objectif",
    noHabits: "Aucune habitude",
    welcomeBack: "Bon retour",
    goodMorning: "Bonjour",
    goodAfternoon: "Bon après-midi",
    goodEvening: "Bonsoir",
    of: "sur",
  },
  it: {
    today: "Oggi",
    goals: "Obiettivi",
    habits: "Abitudini",
    focus: "Concentrazione",
    dailyProgress: "Progresso Giornaliero",
    tasksComplete: "attività completate",
    focusTime: "Tempo di Concentrazione",
    streak: "Serie",
    complete: "completato",
    morning: "Mattina",
    afternoon: "Pomeriggio",
    evening: "Sera",
    night: "Notte",
    addTask: "Aggiungi Attività",
    insights: "Statistiche",
    settings: "Impostazioni",
    language: "Lingua",
    theme: "Tema",
    dark: "Scuro",
    light: "Chiaro",
    system: "Sistema",
    cancel: "Annulla",
    save: "Salva",
    delete: "Elimina",
    edit: "Modifica",
    add: "Aggiungi",
    create: "Crea",
    title: "Titolo",
    description: "Descrizione",
    priority: "Priorità",
    high: "Alta",
    medium: "Media",
    low: "Bassa",
    startFocus: "Inizia Concentrazione",
    pauseFocus: "Pausa",
    resumeFocus: "Riprendi",
    stopFocus: "Ferma",
    focusSession: "Sessione di Concentrazione",
    breakTime: "Pausa",
    deepWork: "Lavoro Profondo",
    pomodoro: "Pomodoro",
    minutes: "minuti",
    hours: "ore",
    days: "giorni",
    week: "settimana",
    month: "mese",
    year: "anno",
    yesterday: "Ieri",
    tomorrow: "Domani",
    thisWeek: "Questa Settimana",
    thisMonth: "Questo Mese",
    completed: "Completato",
    inProgress: "In Corso",
    notStarted: "Non Iniziato",
    overdue: "In Ritardo",
    onTrack: "In Linea",
    habitStreak: "Serie di Abitudini",
    currentStreak: "Serie Attuale",
    longestStreak: "Serie Più Lunga",
    completionRate: "Tasso di Completamento",
    goalProgress: "Progresso Obiettivo",
    addGoal: "Aggiungi Obiettivo",
    addHabit: "Aggiungi Abitudine",
    noTasks: "Nessuna attività",
    noGoals: "Nessun obiettivo",
    noHabits: "Nessuna abitudine",
    welcomeBack: "Bentornato",
    goodMorning: "Buongiorno",
    goodAfternoon: "Buon pomeriggio",
    goodEvening: "Buonasera",
    of: "di",
  },
  pt: {
    today: "Hoje",
    goals: "Metas",
    habits: "Hábitos",
    focus: "Foco",
    dailyProgress: "Progresso Diário",
    tasksComplete: "tarefas concluídas",
    focusTime: "Tempo de Foco",
    streak: "Sequência",
    complete: "completo",
    morning: "Manhã",
    afternoon: "Tarde",
    evening: "Entardecer",
    night: "Noite",
    addTask: "Adicionar Tarefa",
    insights: "Estatísticas",
    settings: "Configurações",
    language: "Idioma",
    theme: "Tema",
    dark: "Escuro",
    light: "Claro",
    system: "Sistema",
    cancel: "Cancelar",
    save: "Salvar",
    delete: "Excluir",
    edit: "Editar",
    add: "Adicionar",
    create: "Criar",
    title: "Título",
    description: "Descrição",
    priority: "Prioridade",
    high: "Alta",
    medium: "Média",
    low: "Baixa",
    startFocus: "Iniciar Foco",
    pauseFocus: "Pausar",
    resumeFocus: "Retomar",
    stopFocus: "Parar",
    focusSession: "Sessão de Foco",
    breakTime: "Intervalo",
    deepWork: "Trabalho Profundo",
    pomodoro: "Pomodoro",
    minutes: "minutos",
    hours: "horas",
    days: "dias",
    week: "semana",
    month: "mês",
    year: "ano",
    yesterday: "Ontem",
    tomorrow: "Amanhã",
    thisWeek: "Esta Semana",
    thisMonth: "Este Mês",
    completed: "Concluído",
    inProgress: "Em Progresso",
    notStarted: "Não Iniciado",
    overdue: "Atrasado",
    onTrack: "No Caminho",
    habitStreak: "Sequência de Hábitos",
    currentStreak: "Sequência Atual",
    longestStreak: "Maior Sequência",
    completionRate: "Taxa de Conclusão",
    goalProgress: "Progresso da Meta",
    addGoal: "Adicionar Meta",
    addHabit: "Adicionar Hábito",
    noTasks: "Sem tarefas",
    noGoals: "Sem metas ainda",
    noHabits: "Sem hábitos ainda",
    welcomeBack: "Bem-vindo de volta",
    goodMorning: "Bom dia",
    goodAfternoon: "Boa tarde",
    goodEvening: "Boa noite",
    of: "de",
  },
  nl: {
    today: "Vandaag",
    goals: "Doelen",
    habits: "Gewoontes",
    focus: "Focus",
    dailyProgress: "Dagelijkse Voortgang",
    tasksComplete: "taken voltooid",
    focusTime: "Focustijd",
    streak: "Reeks",
    complete: "voltooid",
    morning: "Ochtend",
    afternoon: "Middag",
    evening: "Avond",
    night: "Nacht",
    addTask: "Taak Toevoegen",
    insights: "Inzichten",
    settings: "Instellingen",
    language: "Taal",
    theme: "Thema",
    dark: "Donker",
    light: "Licht",
    system: "Systeem",
    cancel: "Annuleren",
    save: "Opslaan",
    delete: "Verwijderen",
    edit: "Bewerken",
    add: "Toevoegen",
    create: "Maken",
    title: "Titel",
    description: "Beschrijving",
    priority: "Prioriteit",
    high: "Hoog",
    medium: "Gemiddeld",
    low: "Laag",
    startFocus: "Focus Starten",
    pauseFocus: "Pauzeren",
    resumeFocus: "Hervatten",
    stopFocus: "Stoppen",
    focusSession: "Focussessie",
    breakTime: "Pauze",
    deepWork: "Diep Werk",
    pomodoro: "Pomodoro",
    minutes: "minuten",
    hours: "uren",
    days: "dagen",
    week: "week",
    month: "maand",
    year: "jaar",
    yesterday: "Gisteren",
    tomorrow: "Morgen",
    thisWeek: "Deze Week",
    thisMonth: "Deze Maand",
    completed: "Voltooid",
    inProgress: "Bezig",
    notStarted: "Niet Begonnen",
    overdue: "Te Laat",
    onTrack: "Op Schema",
    habitStreak: "Gewoonte Reeks",
    currentStreak: "Huidige Reeks",
    longestStreak: "Langste Reeks",
    completionRate: "Voltooiingspercentage",
    goalProgress: "Doel Voortgang",
    addGoal: "Doel Toevoegen",
    addHabit: "Gewoonte Toevoegen",
    noTasks: "Geen taken",
    noGoals: "Nog geen doelen",
    noHabits: "Nog geen gewoontes",
    welcomeBack: "Welkom terug",
    goodMorning: "Goedemorgen",
    goodAfternoon: "Goedemiddag",
    goodEvening: "Goedenavond",
    of: "van",
  },
  pl: {
    today: "Dzisiaj",
    goals: "Cele",
    habits: "Nawyki",
    focus: "Skupienie",
    dailyProgress: "Dzienny Postęp",
    tasksComplete: "zadań ukończonych",
    focusTime: "Czas Skupienia",
    streak: "Seria",
    complete: "ukończono",
    morning: "Rano",
    afternoon: "Popołudnie",
    evening: "Wieczór",
    night: "Noc",
    addTask: "Dodaj Zadanie",
    insights: "Statystyki",
    settings: "Ustawienia",
    language: "Język",
    theme: "Motyw",
    dark: "Ciemny",
    light: "Jasny",
    system: "System",
    cancel: "Anuluj",
    save: "Zapisz",
    delete: "Usuń",
    edit: "Edytuj",
    add: "Dodaj",
    create: "Utwórz",
    title: "Tytuł",
    description: "Opis",
    priority: "Priorytet",
    high: "Wysoki",
    medium: "Średni",
    low: "Niski",
    startFocus: "Rozpocznij Skupienie",
    pauseFocus: "Pauza",
    resumeFocus: "Wznów",
    stopFocus: "Zatrzymaj",
    focusSession: "Sesja Skupienia",
    breakTime: "Przerwa",
    deepWork: "Głęboka Praca",
    pomodoro: "Pomodoro",
    minutes: "minut",
    hours: "godzin",
    days: "dni",
    week: "tydzień",
    month: "miesiąc",
    year: "rok",
    yesterday: "Wczoraj",
    tomorrow: "Jutro",
    thisWeek: "Ten Tydzień",
    thisMonth: "Ten Miesiąc",
    completed: "Ukończone",
    inProgress: "W Trakcie",
    notStarted: "Nie Rozpoczęte",
    overdue: "Przeterminowane",
    onTrack: "Na Dobrej Drodze",
    habitStreak: "Seria Nawyków",
    currentStreak: "Obecna Seria",
    longestStreak: "Najdłuższa Seria",
    completionRate: "Procent Ukończenia",
    goalProgress: "Postęp Celu",
    addGoal: "Dodaj Cel",
    addHabit: "Dodaj Nawyk",
    noTasks: "Brak zadań",
    noGoals: "Brak celów",
    noHabits: "Brak nawyków",
    welcomeBack: "Witaj ponownie",
    goodMorning: "Dzień dobry",
    goodAfternoon: "Dzień dobry",
    goodEvening: "Dobry wieczór",
    of: "z",
  },
};

interface I18nContextType {
  language: Language;
  setLanguage: (lang: Language) => void;
  t: (key: TranslationKey) => string;
}

const I18nContext = createContext<I18nContextType | undefined>(undefined);

export function I18nProvider({ children }: { children: ReactNode }) {
  const [language, setLanguageState] = useState<Language>(() => {
    if (typeof window !== "undefined") {
      const stored = localStorage.getItem("app-language") as Language;
      if (stored && translations[stored]) return stored;
      const browserLang = navigator.language.split("-")[0] as Language;
      if (translations[browserLang]) return browserLang;
    }
    return "en";
  });

  const setLanguage = (lang: Language) => {
    setLanguageState(lang);
    localStorage.setItem("app-language", lang);
  };

  const t = (key: TranslationKey): string => {
    return translations[language][key] || translations.en[key] || key;
  };

  return (
    <I18nContext.Provider value={{ language, setLanguage, t }}>
      {children}
    </I18nContext.Provider>
  );
}

export function useTranslation() {
  const context = useContext(I18nContext);
  if (!context) {
    throw new Error("useTranslation must be used within an I18nProvider");
  }
  return context;
}
