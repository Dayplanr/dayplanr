import { createContext, useContext, useState, useEffect, ReactNode } from "react";
import { supabase } from "./supabase";
import { useAuth } from "./auth";

export type Language = "en" | "de" | "es" | "fr" | "it" | "pt" | "nl" | "pl";

export const languageNames: Record<Language, string> = {
  en: "English",
  de: "Deutsch",
  es: "Español",
  fr: "Français",
  it: "Italiano",
  pt: "Português",
  nl: "Nederlands",
  pl: "Polski",
};

export type TranslationKey =
  | "today"
  | "goals"
  | "habits"
  | "focus"
  | "dailyProgress"
  | "tasksComplete"
  | "focusTime"
  | "streak"
  | "complete"
  | "morning"
  | "afternoon"
  | "evening"
  | "night"
  | "addTask"
  | "insights"
  | "settings"
  | "language"
  | "theme"
  | "dark"
  | "light"
  | "system"
  | "cancel"
  | "save"
  | "delete"
  | "edit"
  | "add"
  | "create"
  | "title"
  | "description"
  | "priority"
  | "high"
  | "medium"
  | "low"
  | "startFocus"
  | "pauseFocus"
  | "resumeFocus"
  | "stopFocus"
  | "focusSession"
  | "breakTime"
  | "deepWork"
  | "pomodoro"
  | "minutes"
  | "hours"
  | "days"
  | "week"
  | "month"
  | "year"
  | "yesterday"
  | "tomorrow"
  | "thisWeek"
  | "thisMonth"
  | "completed"
  | "inProgress"
  | "notStarted"
  | "overdue"
  | "onTrack"
  | "habitStreak"
  | "currentStreak"
  | "longestStreak"
  | "completionRate"
  | "goalProgress"
  | "addGoal"
  | "addHabit"
  | "noTasks"
  | "noGoals"
  | "noHabits"
  | "welcomeBack"
  | "goodMorning"
  | "goodAfternoon"
  | "goodEvening"
  | "of"
  | "account"
  | "profile"
  | "personalData"
  | "privacy"
  | "deleteAccount"
  | "connections"
  | "appleHealth"
  | "calendar"
  | "notifications"
  | "appearance"
  | "themeColor"
  | "appIcon"
  | "general"
  | "haptics"
  | "logOut"
  | "reminderSettings"
  | "reminderDescription"
  | "reminderCategories"
  | "taskReminders"
  | "habitReminders"
  | "focusReminders"
  | "incompleteNudges"
  | "timing"
  | "atTime"
  | "minutesBefore10"
  | "minutesBefore30"
  | "hourBefore"
  | "notificationStyle"
  | "gentle"
  | "important"
  | "reminderNote"
  | "deleteAccountConfirm"
  | "taskTitle"
  | "time"
  | "period"
  | "newTask"
  | "taskTitlePlaceholder"
  | "descriptionOptional"
  | "descriptionPlaceholder"
  | "startTimeOptional"
  | "durationOptional"
  | "linkToHabitOptional"
  | "linkToGoalOptional"
  | "category"
  | "noGoal"
  | "none"
  | "personal"
  | "work"
  | "health"
  | "learning"
  | "other"
  | "taskDeleted"
  | "activeGoals"
  | "progress"
  | "customize"
  | "customizeDashboard"
  | "customizeDashboardDescription"
  | "moduleVisible"
  | "moduleHidden";

type Translations = Record<TranslationKey, string>;

interface LanguageContextType {
  language: Language;
  setLanguage: (lang: Language) => void;
  t: (key: TranslationKey) => string;
}

const LanguageContext = createContext<LanguageContextType | undefined>(undefined);

const translations: Record<Language, Translations> = {
  en: {
    today: "Today",
    goals: "Goals",
    habits: "Habits",
    focus: "Focus",
    dailyProgress: "Daily Progress",
    tasksComplete: "tasks complete",
    focusTime: "Focus Time",
    streak: "Streak",
    complete: "complete",
    morning: "Morning",
    afternoon: "Afternoon",
    evening: "Evening",
    night: "Night",
    addTask: "Add Task",
    insights: "Insights",
    settings: "Settings",
    language: "Language",
    theme: "Theme",
    dark: "Dark",
    light: "Light",
    system: "System",
    cancel: "Cancel",
    save: "Save",
    delete: "Delete",
    edit: "Edit",
    add: "Add",
    create: "Create",
    title: "Title",
    description: "Description",
    priority: "Priority",
    high: "High",
    medium: "Medium",
    low: "Low",
    startFocus: "Start Focus",
    pauseFocus: "Pause",
    resumeFocus: "Resume",
    stopFocus: "Stop",
    focusSession: "Focus Session",
    breakTime: "Break Time",
    deepWork: "Deep Work",
    pomodoro: "Pomodoro",
    minutes: "minutes",
    hours: "hours",
    days: "days",
    week: "week",
    month: "month",
    year: "year",
    yesterday: "Yesterday",
    tomorrow: "Tomorrow",
    thisWeek: "This Week",
    thisMonth: "This Month",
    completed: "Completed",
    inProgress: "In Progress",
    notStarted: "Not Started",
    overdue: "Overdue",
    onTrack: "On Track",
    habitStreak: "Habit Streak",
    currentStreak: "Current Streak",
    longestStreak: "Longest Streak",
    completionRate: "Completion Rate",
    goalProgress: "Goal Progress",
    addGoal: "Add Goal",
    addHabit: "Add Habit",
    noTasks: "No tasks",
    noGoals: "No goals yet",
    noHabits: "No habits yet",
    welcomeBack: "Welcome back",
    goodMorning: "Good morning",
    goodAfternoon: "Good afternoon",
    goodEvening: "Good evening",
    of: "of",
    account: "Account",
    profile: "Profile",
    personalData: "Personal Data",
    privacy: "Privacy",
    deleteAccount: "Delete Account",
    connections: "Connections",
    appleHealth: "Apple Health",
    calendar: "Calendar",
    notifications: "Notifications",
    appearance: "Appearance",
    themeColor: "Theme Color",
    appIcon: "App Icon",
    general: "General",
    haptics: "Haptics",
    logOut: "Log Out",
    reminderSettings: "Reminder Settings",
    reminderDescription: "Customize smart reminders to support your daily planning, habits, and goals.",
    reminderCategories: "Reminder Categories",
    taskReminders: "Task Reminders",
    habitReminders: "Habit Reminders",
    focusReminders: "Focus Reminders",
    incompleteNudges: "Incomplete Task Nudges",
    timing: "Timing",
    atTime: "At scheduled time",
    minutesBefore10: "10 minutes before",
    minutesBefore30: "30 minutes before",
    hourBefore: "1 hour before",
    notificationStyle: "Notification Style",
    gentle: "Gentle",
    important: "Important",
    reminderNote: "Reminders are designed to be supportive and non-intrusive, helping you stay on track without creating pressure.",
    deleteAccountConfirm: "Are you sure you want to delete your account? This action cannot be undone and all your data will be permanently removed.",
    taskTitle: "Task Title",
    time: "Hora",
    period: "Period",
    newTask: "New Task",
    taskTitlePlaceholder: "What do you need to do?",
    descriptionOptional: "Description (Optional)",
    descriptionPlaceholder: "Add more details...",
    startTimeOptional: "Start Time (Optional)",
    durationOptional: "Duration (Optional)",
    linkToHabitOptional: "Link to Habit (Optional)",
    linkToGoalOptional: "Link to Goal (Optional)",
    category: "Category",
    noGoal: "No goal",
    none: "None",
    personal: "Personal",
    work: "Work",
    health: "Health",
    learning: "Learning",
    other: "Other",
    taskDeleted: "Task Deleted",
    activeGoals: "Active Goals",
    progress: "Daily Progress",
    customize: "Customize",
    customizeDashboard: "Customize Dashboard",
    customizeDashboardDescription: "Toggle and reorder your dashboard modules to fit your flow.",
    moduleVisible: "Visible",
    moduleHidden: "Hidden",
  },
  de: {
    today: "Heute",
    goals: "Ziele",
    habits: "Gewohnheiten",
    focus: "Fokus",
    dailyProgress: "Tagesfortschritt",
    tasksComplete: "Aufgaben erledigt",
    focusTime: "Fokuszeit",
    streak: "Serie",
    complete: "erledigt",
    morning: "Morgen",
    afternoon: "Nachmittag",
    evening: "Abend",
    night: "Nacht",
    addTask: "Aufgabe hinzufügen",
    insights: "Einblicke",
    settings: "Einstellungen",
    language: "Sprache",
    theme: "Design",
    dark: "Dunkel",
    light: "Hell",
    system: "System",
    cancel: "Abbrechen",
    save: "Speichern",
    delete: "Löschen",
    edit: "Bearbeiten",
    add: "Hinzufügen",
    create: "Erstellen",
    title: "Titel",
    description: "Beschreibung",
    priority: "Priorität",
    high: "Hoch",
    medium: "Mittel",
    low: "Niedrig",
    startFocus: "Fokus starten",
    pauseFocus: "Pause",
    resumeFocus: "Fortsetzen",
    stopFocus: "Stopp",
    focusSession: "Fokus-Sitzung",
    breakTime: "Pausenzeit",
    deepWork: "Deep Work",
    pomodoro: "Pomodoro",
    minutes: "Minuten",
    hours: "Stunden",
    days: "Tage",
    week: "Woche",
    month: "Monat",
    year: "Jahr",
    yesterday: "Gestern",
    tomorrow: "Morgen",
    thisWeek: "Diese Woche",
    thisMonth: "Dieser Monat",
    completed: "Erledigt",
    inProgress: "In Bearbeitung",
    notStarted: "Nicht begonnen",
    overdue: "Überfällig",
    onTrack: "Auf Kurs",
    habitStreak: "Gewohnheits-Serie",
    currentStreak: "Aktuelle Serie",
    longestStreak: "Längste Serie",
    completionRate: "Abschlussrate",
    goalProgress: "Zielfortschritt",
    addGoal: "Ziel hinzufügen",
    addHabit: "Gewohnheit hinzufügen",
    noTasks: "Keine Aufgaben",
    noGoals: "Noch keine Ziele",
    noHabits: "Noch keine Gewohnheiten",
    welcomeBack: "Willkommen zurück",
    goodMorning: "Guten Morgen",
    goodAfternoon: "Guten Tag",
    goodEvening: "Guten Abend",
    of: "von",
    account: "Konto",
    profile: "Profil",
    personalData: "Persönliche Daten",
    privacy: "Datenschutz",
    deleteAccount: "Konto löschen",
    connections: "Verbindungen",
    appleHealth: "Apple Health",
    calendar: "Kalender",
    notifications: "Benachrichtigungen",
    appearance: "Darstellung",
    themeColor: "Designfarbe",
    appIcon: "App-Symbol",
    general: "Allgemein",
    haptics: "Haptik",
    logOut: "Abmelden",
    reminderSettings: "Erinnerungseinstellungen",
    reminderDescription: "Passen Sie intelligente Erinnerungen an, um Ihre tägliche Planung, Gewohnheiten und Ziele zu unterstützen.",
    reminderCategories: "Erinnerungskategorien",
    taskReminders: "Aufgaben-Erinnerungen",
    habitReminders: "Gewohnheits-Erinnerungen",
    focusReminders: "Fokus-Erinnerungen",
    incompleteNudges: "Unerledigte Aufgaben-Hinweise",
    timing: "Zeitpunkt",
    atTime: "Zur geplanten Zeit",
    minutesBefore10: "10 Minuten vorher",
    minutesBefore30: "30 Minuten vorher",
    hourBefore: "1 Stunde vorher",
    notificationStyle: "Benachrichtigungsstil",
    gentle: "Sanft",
    important: "Wichtig",
    reminderNote: "Erinnerungen sind unterstützend und unaufdringlich gestaltet, um Ihnen zu helfen, auf Kurs zu bleiben, ohne Druck zu erzeugen.",
    deleteAccountConfirm: "Sind Sie sicher, dass Sie Ihr Konto löschen möchten? Diese Aktion kann nicht rückgängig gemacht werden und alle Ihre Daten werden dauerhaft gelöscht.",
    taskTitle: "Aufgabentitel",
    time: "Zeit",
    period: "Zeitraum",
    newTask: "Neue Aufgabe",
    taskTitlePlaceholder: "Was musst du tun?",
    descriptionOptional: "Beschreibung (Optional)",
    descriptionPlaceholder: "Mehr Details hinzufügen...",
    startTimeOptional: "Startzeit (Optional)",
    durationOptional: "Dauer (Optional)",
    linkToHabitOptional: "Mit Gewohnheit verknüpfen (Optional)",
    linkToGoalOptional: "Mit Ziel verknüpfen (Optional)",
    category: "Kategorie",
    noGoal: "Kein Ziel",
    none: "Keine",
    personal: "Persönlich",
    work: "Arbeit",
    health: "Gesundheit",
    learning: "Lernen",
    other: "Andere",
    taskDeleted: "Aufgabe gelöscht",
    activeGoals: "Aktive Ziele",
    progress: "Täglicher Fortschritt",
    customize: "Anpassen",
    customizeDashboard: "Dashboard anpassen",
    customizeDashboardDescription: "Schalte deine Dashboard-Module um und ordne sie neu an.",
    moduleVisible: "Sichtbar",
    moduleHidden: "Verborgen",
  },
  es: {
    today: "Hoy",
    goals: "Metas",
    habits: "Hábitos",
    focus: "Enfoque",
    dailyProgress: "Progreso Diario",
    tasksComplete: "tareas completadas",
    focusTime: "Tiempo de Enfoque",
    streak: "Racha",
    complete: "completado",
    morning: "Mañana",
    afternoon: "Tarde",
    evening: "Atardecer",
    night: "Noche",
    addTask: "Agregar Tarea",
    insights: "Estadísticas",
    settings: "Configuración",
    language: "Idioma",
    theme: "Tema",
    dark: "Oscuro",
    light: "Claro",
    system: "Sistema",
    cancel: "Cancelar",
    save: "Guardar",
    delete: "Eliminar",
    edit: "Editar",
    add: "Agregar",
    create: "Crear",
    title: "Título",
    description: "Descripción",
    priority: "Prioridad",
    high: "Alta",
    medium: "Media",
    low: "Baja",
    startFocus: "Iniciar Enfoque",
    pauseFocus: "Pausar",
    resumeFocus: "Reanudar",
    stopFocus: "Detener",
    focusSession: "Sesión de Enfoque",
    breakTime: "Descanso",
    deepWork: "Trabajo Profundo",
    pomodoro: "Pomodoro",
    minutes: "minutos",
    hours: "horas",
    days: "días",
    week: "semana",
    month: "mes",
    year: "año",
    yesterday: "Ayer",
    tomorrow: "Mañana",
    thisWeek: "Esta Semana",
    thisMonth: "Este Mes",
    completed: "Completado",
    inProgress: "En Progreso",
    notStarted: "No Iniciado",
    overdue: "Atrasado",
    onTrack: "En Curso",
    habitStreak: "Racha de Hábitos",
    currentStreak: "Racha Actual",
    longestStreak: "Racha Más Larga",
    completionRate: "Tasa de Completado",
    goalProgress: "Progreso de Meta",
    addGoal: "Agregar Meta",
    addHabit: "Agregar Hábito",
    noTasks: "Sin tareas",
    noGoals: "Sin metas aún",
    noHabits: "Sin hábitos aún",
    welcomeBack: "Bienvenido de nuevo",
    goodMorning: "Buenos días",
    goodAfternoon: "Buenas tardes",
    goodEvening: "Buenas noches",
    of: "de",
    account: "Cuenta",
    profile: "Perfil",
    personalData: "Datos Personales",
    privacy: "Privacidad",
    deleteAccount: "Eliminar Cuenta",
    connections: "Conexiones",
    appleHealth: "Apple Health",
    calendar: "Calendario",
    notifications: "Notificaciones",
    appearance: "Apariencia",
    themeColor: "Color del Tema",
    appIcon: "Icono de App",
    general: "General",
    haptics: "Hápticos",
    logOut: "Cerrar Sesión",
    reminderSettings: "Ajustes de Recordatorios",
    reminderDescription: "Personaliza recordatorios inteligentes para apoyar tu planificación diaria, hábitos y metas.",
    reminderCategories: "Categorías de Recordatorios",
    taskReminders: "Recordatorios de Tareas",
    habitReminders: "Recordatorios de Hábitos",
    focusReminders: "Recordatorios de Enfoque",
    incompleteNudges: "Avisos de Tareas Incompletas",
    timing: "Momento",
    atTime: "A la hora programada",
    minutesBefore10: "10 minutos antes",
    minutesBefore30: "30 minutos antes",
    hourBefore: "1 hora antes",
    notificationStyle: "Estilo de Notificación",
    gentle: "Suave",
    important: "Importante",
    reminderNote: "Los recordatorios están diseñados para ser útiles y no intrusivos, ayudándote a mantener el rumbo sin crear presión.",
    deleteAccountConfirm: "¿Estás seguro de que quieres eliminar tu cuenta? Esta acción no se puede deshacer y todos tus datos serán eliminados permanentemente.",
    taskTitle: "Título de la Tarea",
    time: "Hora",
    period: "Período",
    newTask: "Nueva Tarea",
    taskTitlePlaceholder: "¿Qué necesitas hacer?",
    descriptionOptional: "Descripción (Opcional)",
    descriptionPlaceholder: "Agregar más detalles...",
    startTimeOptional: "Hora de Inicio (Opcional)",
    durationOptional: "Duración (Opcional)",
    linkToHabitOptional: "Vincular a Hábito (Opcional)",
    linkToGoalOptional: "Vincular a Meta (Opcional)",
    category: "Categoría",
    noGoal: "Sin meta",
    none: "Ninguno",
    personal: "Personal",
    work: "Trabajo",
    health: "Salud",
    learning: "Aprendizaje",
    other: "Otro",
    taskDeleted: "Tarea eliminada",
    activeGoals: "Metas Activas",
    progress: "Progreso Diario",
    customize: "Personalizar",
    customizeDashboard: "Personalizar Panel",
    customizeDashboardDescription: "Activa y reordena los módulos de tu panel para que se adapten a tu ritmo.",
    moduleVisible: "Visible",
    moduleHidden: "Oculto",
  },
  fr: {
    today: "Aujourd'hui",
    goals: "Objectifs",
    habits: "Habitudes",
    focus: "Concentration",
    dailyProgress: "Progrès Quotidien",
    tasksComplete: "tâches terminées",
    focusTime: "Temps de Concentration",
    streak: "Série",
    complete: "terminé",
    morning: "Matin",
    afternoon: "Après-midi",
    evening: "Soir",
    night: "Nuit",
    addTask: "Ajouter une Tâche",
    insights: "Statistiques",
    settings: "Paramètres",
    language: "Langue",
    theme: "Thème",
    dark: "Sombre",
    light: "Clair",
    system: "Système",
    cancel: "Annuler",
    save: "Enregistrer",
    delete: "Supprimer",
    edit: "Modifier",
    add: "Ajouter",
    create: "Créer",
    title: "Titre",
    description: "Description",
    priority: "Priorité",
    high: "Haute",
    medium: "Moyenne",
    low: "Basse",
    startFocus: "Démarrer Concentration",
    pauseFocus: "Pause",
    resumeFocus: "Reprendre",
    stopFocus: "Arrêter",
    focusSession: "Session de Concentration",
    breakTime: "Pause",
    deepWork: "Travail Profond",
    pomodoro: "Pomodoro",
    minutes: "minutes",
    hours: "heures",
    days: "jours",
    week: "semaine",
    month: "mois",
    year: "année",
    yesterday: "Hier",
    tomorrow: "Demain",
    thisWeek: "Cette Semaine",
    thisMonth: "Ce Mois",
    completed: "Terminé",
    inProgress: "En Cours",
    notStarted: "Non Commencé",
    overdue: "En Retard",
    onTrack: "En Bonne Voie",
    habitStreak: "Série d'Habitudes",
    currentStreak: "Série Actuelle",
    longestStreak: "Plus Longue Série",
    completionRate: "Taux de Complétion",
    goalProgress: "Progrès de l'Objectif",
    addGoal: "Ajouter un Objectif",
    addHabit: "Ajouter une Habitude",
    noTasks: "Aucune tâche",
    noGoals: "Aucun objectif",
    noHabits: "Aucune habitude",
    welcomeBack: "Bon retour",
    goodMorning: "Bonjour",
    goodAfternoon: "Bon après-midi",
    goodEvening: "Bonsoir",
    of: "sur",
    account: "Compte",
    profile: "Profil",
    personalData: "Données Personnelles",
    privacy: "Confidentialité",
    deleteAccount: "Supprimer le Compte",
    connections: "Connexions",
    appleHealth: "Apple Health",
    calendar: "Calendrier",
    notifications: "Notifications",
    appearance: "Apparence",
    themeColor: "Couleur du Thème",
    appIcon: "Icône de l'App",
    general: "Général",
    haptics: "Haptiques",
    logOut: "Déconnexion",
    reminderSettings: "Paramètres de Rappels",
    reminderDescription: "Personnalisez les rappels intelligents pour soutenir votre planification quotidienne, vos habitudes et vos objectifs.",
    reminderCategories: "Catégories de Rappels",
    taskReminders: "Rappels de Tâches",
    habitReminders: "Rappels d'Habitudes",
    focusReminders: "Rappels de Concentration",
    incompleteNudges: "Alertes de Tâches Incomplètes",
    timing: "Moment",
    atTime: "À l'heure prévue",
    minutesBefore10: "10 minutes avant",
    minutesBefore30: "30 minutes avant",
    hourBefore: "1 heure avant",
    notificationStyle: "Style de Notification",
    gentle: "Doux",
    important: "Important",
    reminderNote: "Les rappels sont conçus pour être utiles et non intrusifs, vous aidant à rester sur la bonne voie sans créer de pression.",
    deleteAccountConfirm: "Êtes-vous sûr de vouloir supprimer votre compte ? Cette action est irréversible et toutes vos données seront définitivement supprimées.",
    taskTitle: "Titre de la Tâche",
    time: "Heure",
    period: "Période",
    newTask: "Nouvelle Tâche",
    taskTitlePlaceholder: "Que devez-vous faire?",
    descriptionOptional: "Description (Optionnel)",
    descriptionPlaceholder: "Ajouter plus de détails...",
    startTimeOptional: "Heure de Début (Optionnel)",
    durationOptional: "Durée (Optionnel)",
    linkToHabitOptional: "Lier à une Habitude (Optionnel)",
    linkToGoalOptional: "Lier à un Objectif (Optionnel)",
    category: "Catégorie",
    noGoal: "Aucun objectif",
    none: "Aucun",
    personal: "Personnel",
    work: "Travail",
    health: "Santé",
    learning: "Apprentissage",
    other: "Autre",
    taskDeleted: "Tâche supprimée",
    activeGoals: "Objectifs Actifs",
    progress: "Progrès Quotidien",
    customize: "Personnaliser",
    customizeDashboard: "Personnaliser le Tableau de Bord",
    customizeDashboardDescription: "Activez et réorganisez les modules de votre tableau de bord selon vos besoins.",
    moduleVisible: "Visible",
    moduleHidden: "Masqué",
  },
  it: {
    today: "Oggi",
    goals: "Obiettivi",
    habits: "Abitudini",
    focus: "Concentrazione",
    dailyProgress: "Progresso Giornaliero",
    tasksComplete: "attività completate",
    focusTime: "Tempo di Concentrazione",
    streak: "Serie",
    complete: "completato",
    morning: "Mattina",
    afternoon: "Pomeriggio",
    evening: "Sera",
    night: "Notte",
    addTask: "Aggiungi Attività",
    insights: "Statistiche",
    settings: "Impostazioni",
    language: "Lingua",
    theme: "Tema",
    dark: "Scuro",
    light: "Chiaro",
    system: "Sistema",
    cancel: "Annulla",
    save: "Salva",
    delete: "Elimina",
    edit: "Modifica",
    add: "Aggiungi",
    create: "Crea",
    title: "Titolo",
    description: "Descrizione",
    priority: "Priorità",
    high: "Alta",
    medium: "Media",
    low: "Bassa",
    startFocus: "Inizia Concentrazione",
    pauseFocus: "Pausa",
    resumeFocus: "Riprendi",
    stopFocus: "Ferma",
    focusSession: "Sessione di Concentrazione",
    breakTime: "Pausa",
    deepWork: "Lavoro Profondo",
    pomodoro: "Pomodoro",
    minutes: "minuti",
    hours: "ore",
    days: "giorni",
    week: "settimana",
    month: "mese",
    year: "anno",
    yesterday: "Ieri",
    tomorrow: "Domani",
    thisWeek: "Questa Settimana",
    thisMonth: "Questo Mese",
    completed: "Completato",
    inProgress: "In Corso",
    notStarted: "Non Iniziato",
    overdue: "In Ritardo",
    onTrack: "In Linea",
    habitStreak: "Serie di Abitudini",
    currentStreak: "Serie Attuale",
    longestStreak: "Serie Più Lunga",
    completionRate: "Tasso di Completamento",
    goalProgress: "Progresso Obiettivo",
    addGoal: "Aggiungi Obiettivo",
    addHabit: "Aggiungi Abitudine",
    noTasks: "Nessuna attività",
    noGoals: "Nessun obiettivo",
    noHabits: "Nessuna abitudine",
    welcomeBack: "Bentornato",
    goodMorning: "Buongiorno",
    goodAfternoon: "Buon pomeriggio",
    goodEvening: "Buonasera",
    of: "di",
    account: "Account",
    profile: "Profilo",
    personalData: "Dati Personali",
    privacy: "Privacy",
    deleteAccount: "Elimina Account",
    connections: "Connessioni",
    appleHealth: "Apple Health",
    calendar: "Calendario",
    notifications: "Notifiche",
    appearance: "Aspetto",
    themeColor: "Colore Tema",
    appIcon: "Icona App",
    general: "Generale",
    haptics: "Feedback Aptico",
    logOut: "Esci",
    reminderSettings: "Impostazioni Promemoria",
    reminderDescription: "Personalizza promemoria intelligenti per supportare la tua pianificazione quotidiana, abitudini e obiettivi.",
    reminderCategories: "Categorie Promemoria",
    taskReminders: "Promemoria Attività",
    habitReminders: "Promemoria Abitudini",
    focusReminders: "Promemoria Focus",
    incompleteNudges: "Avvisi Attività Incomplete",
    timing: "Tempistiche",
    atTime: "All'orario programmato",
    minutesBefore10: "10 minuti prima",
    minutesBefore30: "30 minuti prima",
    hourBefore: "1 ora prima",
    notificationStyle: "Stile Notifica",
    gentle: "Delicato",
    important: "Importante",
    reminderNote: "I promemoria sono progettati per essere di supporto e non invasivi, aiutandoti a rimanere in carreggiata senza creare pressione.",
    deleteAccountConfirm: "Sei sicuro di voler eliminare il tuo account? Questa azione non può essere annullata e tutti i tuoi dati verranno eliminati permanentemente.",
    taskTitle: "Titolo dell'Attività",
    time: "Ora",
    period: "Periodo",
    newTask: "Nuova Attività",
    taskTitlePlaceholder: "Cosa devi fare?",
    descriptionOptional: "Descrizione (Opzionale)",
    descriptionPlaceholder: "Aggiungi più dettagli...",
    startTimeOptional: "Ora di Inizio (Opzionale)",
    durationOptional: "Durata (Opzionale)",
    linkToHabitOptional: "Collega a un'Abitudine (Opzionale)",
    linkToGoalOptional: "Collega a un Obiettivo (Opzionale)",
    category: "Categoria",
    noGoal: "Nessun obiettivo",
    none: "Nessuno",
    personal: "Personale",
    work: "Lavoro",
    health: "Salute",
    learning: "Apprendimento",
    other: "Altro",
    taskDeleted: "Attività eliminata",
    activeGoals: "Obiettivi Attivi",
    progress: "Progresso Giornaliero",
    customize: "Personalizza",
    customizeDashboard: "Personalizza Dashboard",
    customizeDashboardDescription: "Attiva e riordina i moduli della tua dashboard in base al tuo flusso.",
    moduleVisible: "Visibile",
    moduleHidden: "Nascosto",
  },
  pt: {
    today: "Hoje",
    goals: "Metas",
    habits: "Hábitos",
    focus: "Foco",
    dailyProgress: "Progresso Diário",
    tasksComplete: "tarefas concluídas",
    focusTime: "Tempo de Foco",
    streak: "Sequência",
    complete: "completo",
    morning: "Manhã",
    afternoon: "Tarde",
    evening: "Entardecer",
    night: "Noite",
    addTask: "Adicionar Tarefa",
    insights: "Estatísticas",
    settings: "Configurações",
    language: "Idioma",
    theme: "Tema",
    dark: "Escuro",
    light: "Claro",
    system: "Sistema",
    cancel: "Cancelar",
    save: "Salvar",
    delete: "Excluir",
    edit: "Editar",
    add: "Adicionar",
    create: "Criar",
    title: "Título",
    description: "Descrição",
    priority: "Prioridade",
    high: "Alta",
    medium: "Média",
    low: "Baixa",
    startFocus: "Iniciar Foco",
    pauseFocus: "Pausa",
    resumeFocus: "Retomar",
    stopFocus: "Parar",
    focusSession: "Sessão de Foco",
    breakTime: "Intervalo",
    deepWork: "Trabalho Profundo",
    pomodoro: "Pomodoro",
    minutes: "minutos",
    hours: "horas",
    days: "dias",
    week: "semana",
    month: "mês",
    year: "ano",
    yesterday: "Ontem",
    tomorrow: "Amanhã",
    thisWeek: "Esta Semana",
    thisMonth: "Este Mês",
    completed: "Concluído",
    inProgress: "Em Progresso",
    notStarted: "Não Iniciado",
    overdue: "Atrasado",
    onTrack: "No Caminho",
    habitStreak: "Sequência de Hábitos",
    currentStreak: "Sequência Atual",
    longestStreak: "Maior Sequência",
    completionRate: "Taxa de Conclusão",
    goalProgress: "Progresso da Meta",
    addGoal: "Adicionar Meta",
    addHabit: "Adicionar Hábito",
    noTasks: "Sem tarefas",
    noGoals: "Sem metas ainda",
    noHabits: "Sem hábitos ainda",
    welcomeBack: "Bem-vindo de volta",
    goodMorning: "Bom dia",
    goodAfternoon: "Boa tarde",
    goodEvening: "Boa noite",
    of: "de",
    account: "Conta",
    profile: "Perfil",
    personalData: "Dados Pessoais",
    privacy: "Privacidade",
    deleteAccount: "Excluir Conta",
    connections: "Conexões",
    appleHealth: "Apple Health",
    calendar: "Calendário",
    notifications: "Notificações",
    appearance: "Aparência",
    themeColor: "Cor do Tema",
    appIcon: "Ícone do App",
    general: "Geral",
    haptics: "Feedback Aptico",
    logOut: "Sair",
    reminderSettings: "Configurações de Lembrete",
    reminderDescription: "Personalize lembretes inteligentes para apoiar seu planejamento diário, hábitos e metas.",
    reminderCategories: "Categorias de Lembrete",
    taskReminders: "Lembretes de Tarefas",
    habitReminders: "Lembretes de Hábitos",
    focusReminders: "Lembretes de Foco",
    incompleteNudges: "Avisos de Tarefas Incompletas",
    timing: "Tempo",
    atTime: "Na hora marcada",
    minutesBefore10: "10 minutos antes",
    minutesBefore30: "30 minutos antes",
    hourBefore: "1 hora antes",
    notificationStyle: "Estilo de Notificação",
    gentle: "Suave",
    important: "Importante",
    reminderNote: "Os lembretes são projetados para apoiar e não serem intrusivos, ajudando você a manter o ritmo sem criar pressão.",
    deleteAccountConfirm: "Tem certeza que deseja excluir sua conta? Esta ação não pode ser desfeita e todos os seus dados serão removidos permanentemente.",
    taskTitle: "Título da Tarefa",
    time: "Hora",
    period: "Período",
    newTask: "Nova Tarefa",
    taskTitlePlaceholder: "O que você precisa fazer?",
    descriptionOptional: "Descrição (Opcional)",
    descriptionPlaceholder: "Adicionar mais detalhes...",
    startTimeOptional: "Hora de Início (Opcional)",
    durationOptional: "Duração (Opcional)",
    linkToHabitOptional: "Vincular a Hábito (Opcional)",
    linkToGoalOptional: "Vincular a Meta (Opcional)",
    category: "Categoria",
    noGoal: "Sem meta",
    none: "Nenhum",
    personal: "Pessoal",
    work: "Trabalho",
    health: "Saúde",
    learning: "Aprendizado",
    other: "Outro",
    taskDeleted: "Tarefa excluída",
    activeGoals: "Metas Ativas",
    progress: "Progresso Diário",
    customize: "Personalizar",
    customizeDashboard: "Personalizar Painel",
    customizeDashboardDescription: "Ative e reordene os módulos do seu painel para se adequar ao seu fluxo.",
    moduleVisible: "Visível",
    moduleHidden: "Oculto",
  },
  nl: {
    today: "Vandaag",
    goals: "Doelen",
    habits: "Gewoontes",
    focus: "Focus",
    dailyProgress: "Dagelijkse Voortgang",
    tasksComplete: "taken voltooid",
    focusTime: "Focustijd",
    streak: "Reeks",
    complete: "voltooid",
    morning: "Ochtend",
    afternoon: "Middag",
    evening: "Avond",
    night: "Nacht",
    addTask: "Taak Toevoegen",
    insights: "Inzichten",
    settings: "Instellingen",
    language: "Taal",
    theme: "Thema",
    dark: "Donker",
    light: "Licht",
    system: "Systeem",
    cancel: "Annuleren",
    save: "Opslaan",
    delete: "Verwijderen",
    edit: "Bewerken",
    add: "Toevoegen",
    create: "Maken",
    title: "Titel",
    description: "Beschrijving",
    priority: "Prioriteit",
    high: "Hoog",
    medium: "Gemiddeld",
    low: "Laag",
    startFocus: "Start Focus",
    pauseFocus: "Pauze",
    resumeFocus: "Hervatten",
    stopFocus: "Stoppen",
    focusSession: "Focussessie",
    breakTime: "Pauze",
    deepWork: "Deep Work",
    pomodoro: "Pomodoro",
    minutes: "minuten",
    hours: "uren",
    days: "dagen",
    week: "week",
    month: "maand",
    year: "jaar",
    yesterday: "Gisteren",
    tomorrow: "Morgen",
    thisWeek: "Deze Week",
    thisMonth: "Deze Maand",
    completed: "Voltooid",
    inProgress: "In Uitvoering",
    notStarted: "Niet Gestart",
    overdue: "Te laat",
    onTrack: "Op Koers",
    habitStreak: "Gewoontereeks",
    currentStreak: "Huidige Reeks",
    longestStreak: "Langste Reeks",
    completionRate: "Voltooiingspercentage",
    goalProgress: "Doelvoortgang",
    addGoal: "Doel Toevoegen",
    addHabit: "Gewoonte Toevoegen",
    noTasks: "Geen taken",
    noGoals: "Nog geen doelen",
    noHabits: "Nog geen gewoontes",
    welcomeBack: "Welkom terug",
    goodMorning: "Goedemorgen",
    goodAfternoon: "Goedemiddag",
    goodEvening: "Goedenavond",
    of: "van de",
    account: "Account",
    profile: "Profiel",
    personalData: "Persoonlijke Gegevens",
    privacy: "Privacy",
    deleteAccount: "Account Verwijderen",
    connections: "Verbindingen",
    appleHealth: "Apple Health",
    calendar: "Agenda",
    notifications: "Meldingen",
    appearance: "Uiterlijk",
    themeColor: "Themakleur",
    appIcon: "App-icoon",
    general: "Algemeen",
    haptics: "Haptiek",
    logOut: "Uitloggen",
    reminderSettings: "Herinneringsinstellingen",
    reminderDescription: "Personaliseer slimme herinneringen om je dagelijkse planning, gewoontes en doelen te ondersteunen.",
    reminderCategories: "Herinneringscategorieën",
    taskReminders: "Taakherinneringen",
    habitReminders: "Gewoonteherinneringen",
    focusReminders: "Focusherinneringen",
    incompleteNudges: "Meldingen Onvoltooide Taken",
    timing: "Timing",
    atTime: "Op geplande tijd",
    minutesBefore10: "10 minuten van tevoren",
    minutesBefore30: "30 minuten van tevoren",
    hourBefore: "1 uur van tevoren",
    notificationStyle: "Meldingstijl",
    gentle: "Zacht",
    important: "Belangrijk",
    reminderNote: "Herinneringen zijn ontworpen om ondersteunend en niet-storend te zijn, zodat je op koers blijft zonder druk.",
    deleteAccountConfirm: "Weet je zeker dat je je account wilt verwijderen? Dit kan niet ongedaan worden gemaakt en al je gegevens worden permanent verwijderd.",
    taskTitle: "Taaktitel",
    time: "Tijd",
    period: "Periode",
    newTask: "Nieuwe Taak",
    taskTitlePlaceholder: "Wat moet je doen?",
    descriptionOptional: "Beschrijving (Optioneel)",
    descriptionPlaceholder: "Voeg details toe...",
    startTimeOptional: "Starttijd (Optioneel)",
    durationOptional: "Duur (Optioneel)",
    linkToHabitOptional: "Link naar Gewoonte (Optioneel)",
    linkToGoalOptional: "Link naar Doel (Optioneel)",
    category: "Categorie",
    noGoal: "Geen doel",
    none: "Geen",
    personal: "Persoonlijk",
    work: "Werk",
    health: "Gezondheid",
    learning: "Leren",
    other: "Overig",
    taskDeleted: "Taak Verwijderd",
    activeGoals: "Actieve Doelen",
    progress: "Dagelijkse Voortgang",
    customize: "Aanpassen",
    customizeDashboard: "Dashboard Aanpassen",
    customizeDashboardDescription: "Schakel dashboardmodules in en wijzig de volgorde naar wens.",
    moduleVisible: "Zichtbaar",
    moduleHidden: "Verborgen",
  },
  pl: {
    today: "Dzisiaj",
    goals: "Cele",
    habits: "Nawyki",
    focus: "Focus",
    dailyProgress: "Dzienny Postęp",
    tasksComplete: "zadań ukończonych",
    focusTime: "Czas Focusu",
    streak: "Seria",
    complete: "ukończone",
    morning: "Rano",
    afternoon: "Popołudnie",
    evening: "Wieczór",
    night: "Noc",
    addTask: "Dodaj Zadanie",
    insights: "Statystyki",
    settings: "Ustawienia",
    language: "Język",
    theme: "Motyw",
    dark: "Ciemny",
    light: "Jasny",
    system: "Systemowy",
    cancel: "Anuluj",
    save: "Zapisz",
    delete: "Usuń",
    edit: "Edytuj",
    add: "Dodaj",
    create: "Utwórz",
    title: "Tytuł",
    description: "Opis",
    priority: "Priorytet",
    high: "Wysoki",
    medium: "Średni",
    low: "Niski",
    startFocus: "Rozpocznij Focus",
    pauseFocus: "Pauza",
    resumeFocus: "Wznów",
    stopFocus: "Zatrzymaj",
    focusSession: "Sesja Focusu",
    breakTime: "Czas przerwy",
    deepWork: "Praca Głęboka",
    pomodoro: "Pomodoro",
    minutes: "minut",
    hours: "godzin",
    days: "dni",
    week: "tydzień",
    month: "miesiąc",
    year: "rok",
    yesterday: "Wczoraj",
    tomorrow: "Jutro",
    thisWeek: "Ten Tydzień",
    thisMonth: "Ten Miesiąc",
    completed: "Ukończone",
    inProgress: "W Trakcie",
    notStarted: "Nie Rozpoczęte",
    overdue: "Zaległe",
    onTrack: "Zgodnie z Planem",
    habitStreak: "Seria Nawyków",
    currentStreak: "Aktualna Seria",
    longestStreak: "Najdłuższa Seria",
    completionRate: "Wskaźnik Ukończenia",
    goalProgress: "Postęp Celu",
    addGoal: "Dodaj Cel",
    addHabit: "Dodaj Nawyk",
    noTasks: "Brak zadań",
    noGoals: "Brak celów",
    noHabits: "Brak nawyków",
    welcomeBack: "Witaj ponownie",
    goodMorning: "Dzień dobry",
    goodAfternoon: "Dzień dobry",
    goodEvening: "Dobry wieczór",
    of: "z",
    account: "Konto",
    profile: "Profil",
    personalData: "Dane Osobowe",
    privacy: "Prywatność",
    deleteAccount: "Usuń Konto",
    connections: "Połączenia",
    appleHealth: "Apple Health",
    calendar: "Kalendarz",
    notifications: "Powiadomienia",
    appearance: "Wygląd",
    themeColor: "Kolor Motywu",
    appIcon: "Ikona Aplikacji",
    general: "Ogólne",
    haptics: "Haptyka",
    logOut: "Wyloguj Się",
    reminderSettings: "Ustawienia Przypomnień",
    reminderDescription: "Spersonalizuj inteligentne przypomnienia, aby wspierać codzienne planowanie, nawyki i cele.",
    reminderCategories: "Kategorie Przypomnień",
    taskReminders: "Przypomnienia o Zadaniach",
    habitReminders: "Przypomnienia o Nawykach",
    focusReminders: "Przypomnienia Focusu",
    incompleteNudges: "Powiadomienia o Niezakończonych Zadaniach",
    timing: "Czas",
    atTime: "O zaplanowanej godzinie",
    minutesBefore10: "10 minut wcześniej",
    minutesBefore30: "30 minut wcześniej",
    hourBefore: "1 godzina wcześniej",
    notificationStyle: "Styl Powiadomień",
    gentle: "Delikatny",
    important: "Ważny",
    reminderNote: "Przypomnienia są zaprojektowane tak, aby wspierać i nie przeszkadzać, pomagając Ci trzymać się planu bez poczucia presji.",
    deleteAccountConfirm: "Czy na pewno chcesz usunąć konto? Tej akcji nie można cofnąć, a wszystkie Twoje dane zostaną trwale usunięte.",
    taskTitle: "Tytuł Zadania",
    time: "Godzina",
    period: "Pora",
    newTask: "Nowe Zadanie",
    taskTitlePlaceholder: "Co masz do zrobienia?",
    descriptionOptional: "Opis (Opcjonalnie)",
    descriptionPlaceholder: "Dodaj więcej szczegółów...",
    startTimeOptional: "Godzina Rozpoczęcia (Opcjonalnie)",
    durationOptional: "Czas Trwania (Opcjonalnie)",
    linkToHabitOptional: "Połącz z Nawykiem (Opcjonalnie)",
    linkToGoalOptional: "Połącz z Celem (Opcjonalnie)",
    category: "Kategoria",
    noGoal: "Brak celu",
    none: "Brak",
    personal: "Osobiste",
    work: "Praca",
    health: "Zdrowie",
    learning: "Nauka",
    other: "Inne",
    taskDeleted: "Zadanie usunięte",
    activeGoals: "Aktywne Cele",
    progress: "Dzienny Postęp",
    customize: "Dostosuj",
    customizeDashboard: "Dostosuj Pulpit",
    customizeDashboardDescription: "Przełączaj i zmieniaj kolejność modułów pulpitu, aby dopasować je do swojego rytmu.",
    moduleVisible: "Widoczny",
    moduleHidden: "Ukryty",
  },
};

export function LanguageProvider({ children }: { children: ReactNode }) {
  const [language, setLanguageState] = useState<Language>("en");
  const { user } = useAuth();

  useEffect(() => {
    // Load persisted language from Supabase or localStorage
    const loadSettings = async () => {
      if (user) {
        const { data, error } = await supabase
          .from("user_settings")
          .select("language")
          .eq("user_id", user.id)
          .single();

        if (data?.language && (data.language in languageNames)) {
          setLanguageState(data.language as Language);
          localStorage.setItem("language", data.language);
        }
      } else {
        const saved = localStorage.getItem("language");
        if (saved && (saved in languageNames)) {
          setLanguageState(saved as Language);
        }
      }
    };

    loadSettings();
  }, [user]);

  const setLanguage = async (lang: Language) => {
    setLanguageState(lang);
    localStorage.setItem("language", lang);

    if (user) {
      await supabase
        .from("user_settings")
        .update({ language: lang })
        .eq("user_id", user.id);
    }
  };

  const t = (key: TranslationKey): string => {
    const translation = translations[language][key];
    if (!translation) {
      console.warn(`Missing translation for key: ${key} in language: ${language}`);
      return translations.en[key] || key;
    }
    return translation;
  };

  return (
    <LanguageContext.Provider value={{ language, setLanguage, t }}>
      {children}
    </LanguageContext.Provider>
  );
}

export function useTranslation() {
  const context = useContext(LanguageContext);
  if (!context) {
    throw new Error("useTranslation must be used within a LanguageProvider");
  }
  return context;
}
